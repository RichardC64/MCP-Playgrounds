<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
</head>
<body>

<div>Javascript client</div>
<div id="messages"></div>
<div id="error"></div>

<button id="stop" style="margin-top:20px;">Stop</button>

    <script>
        const evtSource = new EventSource("/sse?action=MSFT");
        console.log("Création de la connexion SSE: ", evtSource);
        console.log(evtSource.withCredentials);
        console.log(evtSource.readyState);
        console.log(evtSource.url);

        evtSource.onopen = () => {
            console.log("Connecté au serveur : " + evtSource.readyState);
            console.log(evtSource.readyState);

        evtSource.onmessage = (event) => {
            console.log("Message reçu :", event.data);
            document.getElementById("messages").innerText = event.data;
        };

        evtSource.onerror = (event) => {
            console.error("Erreur de connexion SSE: ", event);
            document.getElementById("error").innerText = event.data;
            };
        }

        document.getElementById("stop").onclick = function () {
            evtSource.close();
            console.log("Connection au serveur fermée : " + evtSource.readyState);
        };
    </script>
</body>
</html>